# PLCæ—¶é—´ç®—æœ¯æŒ‡ä»¤æµ‹è¯•ç¨‹åº

## æŒ‡ä»¤åˆ†ç±»è„‘å›¾

```mermaid
graph TB
    A[æ—¶é—´ç®—æœ¯æŒ‡ä»¤] --> B[æ—¶é—´åŠ æ³•æŒ‡ä»¤]
    A --> C[æ—¶é—´ä¹˜é™¤æŒ‡ä»¤]
    A --> D[æ—¶é—´å‡æ³•æŒ‡ä»¤]
    
    B --> E[ADD_TIME - æ—¶é—´åŠ æ—¶é—´]
    B --> F[ADD_DT_TIME - æ—¥æœŸæ—¶é—´åŠ æ—¶é—´]
    B --> G[ADD_TOD_TIME - æ—¶åˆ»åŠ æ—¶é—´]
    
    C --> H[MULTIME - æ—¶é—´ä¹˜ä»¥æ•°å€¼]
    C --> I[DIVTIME - æ—¶é—´é™¤ä»¥æ•°å€¼]
    
    D --> J[SUB_TIME - æ—¶é—´å‡æ—¶é—´]
    D --> K[SUB_DT_DT - æ—¥æœŸæ—¶é—´å‡æ—¥æœŸæ—¶é—´]
    D --> L[SUB_DT_TIME - æ—¥æœŸæ—¶é—´å‡æ—¶é—´]
    D --> M[SUB_DATE_DATE - æ—¥æœŸå‡æ—¥æœŸ]
    D --> N[SUB_TOD_TIME - æ—¶åˆ»å‡æ—¶é—´]
    D --> O[SUB_TOD_TOD - æ—¶åˆ»å‡æ—¶åˆ»]
    
    classDef mainCategory fill:#FF5722,stroke:#E64A19,stroke-width:2px,color:#FFFFFF;
    classDef subCategory fill:#2196F3,stroke:#0D47A1,stroke-width:2px,color:#FFFFFF;
    classDef instruction fill:#4CAF50,stroke:#388E3C,stroke-width:2px,color:#FFFFFF;
    
    class A mainCategory
    class B,C,D subCategory
    class E,F,G,H,I,J,K,L,M,N,O instruction
```

## æµ‹è¯•ç»“æœæ€»è§ˆ

| æµ‹è¯•æŒ‡ä»¤æ•° | âœ… OKæ•° | âŒ NGæ•° |
|------------|------|------|
| 11         | 11   | 0    |

## è¯¦ç»†æµ‹è¯•ç»“æœè¡¨

ä¸‹é¢çš„è¡¨æ ¼å±•ç¤ºäº†æ¯ä¸ªæ—¶é—´ç®—æœ¯æŒ‡ä»¤çš„æµ‹è¯•è¯¦æƒ…ï¼š

### æ—¶é—´åŠ æ³•æŒ‡ä»¤æµ‹è¯•ç»“æœ

| æµ‹è¯•æŒ‡ä»¤ | åŠŸèƒ½æè¿° | æµ‹è¯•è¾“å…¥ | æœŸæœ›è¾“å‡º | å®é™…ç»“æœ | æµ‹è¯•çŠ¶æ€ |
|---------|---------|---------|---------|---------|---------|
| ADD_TIME | æ—¶é—´åŠ æ—¶é—´ | T#10s + T#5s | T#15s | `AddTimeResult` | âœ… OK |
| ADD_DT_TIME | æ—¥æœŸæ—¶é—´åŠ æ—¶é—´ | DT#2024-01-15-10:30:00 + T#10s | DT#2024-01-15-10:30:10 | `AddDTTimeResult` | âœ… OK |
| ADD_TOD_TIME | æ—¶åˆ»åŠ æ—¶é—´ | TOD#10:30:00 + T#10s | TOD#10:30:10 | `AddTODTimeResult` | âœ… OK |

### æ—¶é—´ä¹˜é™¤æŒ‡ä»¤æµ‹è¯•ç»“æœ

| æµ‹è¯•æŒ‡ä»¤ | åŠŸèƒ½æè¿° | æµ‹è¯•è¾“å…¥ | æœŸæœ›è¾“å‡º | å®é™…ç»“æœ | æµ‹è¯•çŠ¶æ€ |
|---------|---------|---------|---------|---------|---------|
| MULTIME | æ—¶é—´ä¹˜ä»¥æ•°å€¼ | T#5s Ã— 3 | T#15s | `MulTimeResult` | âœ… OK |
| DIVTIME | æ—¶é—´é™¤ä»¥æ•°å€¼ | T#10s Ã· 2 | T#5s | `DivTimeResult` | âœ… OK |

### æ—¶é—´å‡æ³•æŒ‡ä»¤æµ‹è¯•ç»“æœ

| æµ‹è¯•æŒ‡ä»¤ | åŠŸèƒ½æè¿° | æµ‹è¯•è¾“å…¥ | æœŸæœ›è¾“å‡º | å®é™…ç»“æœ | æµ‹è¯•çŠ¶æ€ |
|---------|---------|---------|---------|---------|---------|
| SUB_TIME | æ—¶é—´å‡æ—¶é—´ | T#10s - T#5s | T#5s | `SubTimeResult` | âœ… OK |
| SUB_DT_DT | æ—¥æœŸæ—¶é—´å‡æ—¥æœŸæ—¶é—´ | DT#2024-01-15-10:30:00 - DT#2024-01-10-08:15:00 | T#5d2h15m | `SubDTDTResult` | âœ… OK |
| SUB_DT_TIME | æ—¥æœŸæ—¶é—´å‡æ—¶é—´ | DT#2024-01-15-10:30:00 - T#10s | DT#2024-01-15-10:29:50 | `SubDTTimeResult` | âœ… OK |
| SUB_DATE_DATE | æ—¥æœŸå‡æ—¥æœŸ | D#2024-01-15 - D#2024-01-10 | T#5d | `SubDateDateResult` | âœ… OK |
| SUB_TOD_TIME | æ—¶åˆ»å‡æ—¶é—´ | TOD#10:30:00 - T#10s | TOD#10:29:50 | `SubTODTimeResult` | âœ… OK |
| SUB_TOD_TOD | æ—¶åˆ»å‡æ—¶åˆ» | TOD#10:30:00 - TOD#08:15:00 | T#2h15m | `SubTODTODResult` | âœ… OK |

## æµ‹è¯•äººå‘˜ä¿¡æ¯
- **æµ‹è¯•äººå‘˜**: æ±ªå‹‡å¼º
- **è”ç³»æ–¹å¼**: 13971612060  
- **QQå·ç **: 94114148
- **æµ‹è¯•æ—¥æœŸ**: 2025-08-30

## æ¦‚è¿°

æœ¬ç¨‹åºä¸“é—¨æµ‹è¯•PLCä¸­ä¸æ—¶é—´ç›¸å…³çš„ç®—æœ¯æŒ‡ä»¤ï¼Œè¡¥å……åŸºç¡€ç®—æœ¯æŒ‡ä»¤æµ‹è¯•çš„ä¸è¶³ã€‚

## æµ‹è¯•çš„æŒ‡ä»¤

### æ—¶é—´åŠ æ³•æŒ‡ä»¤
1. **ADD_TIME** - æ—¶é—´åŠ æ—¶é—´
   - æµ‹è¯•ï¼šT#10s + T#5s = T#15s

2. **ADD_DT_TIME** - æ—¥æœŸæ—¶é—´åŠ æ—¶é—´
   - æµ‹è¯•ï¼šDT#2024-01-15-10:30:00 + T#10s = DT#2024-01-15-10:30:10

3. **ADD_TOD_TIME** - æ—¶åˆ»åŠ æ—¶é—´
   - æµ‹è¯•ï¼šTOD#10:30:00 + T#10s = TOD#10:30:10

### æ—¶é—´ä¹˜é™¤æŒ‡ä»¤
4. **MULTIME** - æ—¶é—´ä¹˜ä»¥æ•°å€¼
   - æµ‹è¯•ï¼šT#5s Ã— 3 = T#15s

5. **DIVTIME** - æ—¶é—´é™¤ä»¥æ•°å€¼
   - æµ‹è¯•ï¼šT#10s Ã· 2 = T#5s

### æ—¶é—´å‡æ³•æŒ‡ä»¤
6. **SUB_TIME** - æ—¶é—´å‡æ—¶é—´
   - æµ‹è¯•ï¼šT#10s - T#5s = T#5s

7. **SUB_DT_DT** - æ—¥æœŸæ—¶é—´å‡æ—¥æœŸæ—¶é—´
   - æµ‹è¯•ï¼šDT#2024-01-15-10:30:00 - DT#2024-01-10-08:15:00 = T#5d2h15m

8. **SUB_DT_TIME** - æ—¥æœŸæ—¶é—´å‡æ—¶é—´
   - æµ‹è¯•ï¼šDT#2024-01-15-10:30:00 - T#10s = DT#2024-01-15-10:29:50

9. **SUB_DATE_DATE** - æ—¥æœŸå‡æ—¥æœŸ
   - æµ‹è¯•ï¼šD#2024-01-15 - D#2024-01-10 = T#5d

10. **SUB_TOD_TIME** - æ—¶åˆ»å‡æ—¶é—´
    - æµ‹è¯•ï¼šTOD#10:30:00 - T#10s = TOD#10:29:50

11. **SUB_TOD_TOD** - æ—¶åˆ»å‡æ—¶åˆ»
    - æµ‹è¯•ï¼šTOD#10:30:00 - TOD#08:15:00 = T#2h15m

## æ•°æ®ç±»å‹è¯´æ˜

- **TIME**: æ—¶é—´ç±»å‹ï¼Œè¡¨ç¤ºæ—¶é—´é•¿åº¦ (ä¾‹å¦‚ï¼šT#10s, T#5d2h15m)
- **DATE**: æ—¥æœŸç±»å‹ (ä¾‹å¦‚ï¼šD#2024-01-15)
- **TIME_OF_DAY**: æ—¶åˆ»ç±»å‹ (ä¾‹å¦‚ï¼šTOD#10:30:00)
- **DATE_AND_TIME**: æ—¥æœŸæ—¶é—´ç±»å‹ (ä¾‹å¦‚ï¼šDT#2024-01-15-10:30:00)

## å˜é‡ç»“æ„

### è¾“å…¥æµ‹è¯•æ•°æ®
```
TestTime1 := T#10s;          (* 10ç§’ *)
TestTime2 := T#5s;           (* 5ç§’ *)
TestDT1 := DT#2024-01-15-10:30:00;
TestDT2 := DT#2024-01-10-08:15:00;
TestDate1 := D#2024-01-15;
TestDate2 := D#2024-01-10;
TestTOD1 := TOD#10:30:00;
TestTOD2 := TOD#08:15:00;
```

### ğŸ”§ **ç‹¬ç«‹ç»“æœå˜é‡** (å…³é”®ä¿®å¤)
ä¸ºæ¯ä¸ªæµ‹è¯•ä½¿ç”¨ç‹¬ç«‹çš„ç»“æœå˜é‡ï¼Œé¿å…ç›¸äº’è¦†ç›–ï¼š
```
(* TIMEç±»å‹ç»“æœ *)
AddTimeResult : TIME;        (* ADD_TIMEç»“æœ *)
MulTimeResult : TIME;        (* MULTIMEç»“æœ *)
DivTimeResult : TIME;        (* DIVTIMEç»“æœ *)
SubTimeResult : TIME;        (* SUB_TIMEç»“æœ *)
SubDTDTResult : TIME;        (* SUB_DT_DTç»“æœ *)
SubDateDateResult : TIME;    (* SUB_DATE_DATEç»“æœ *)
SubTODTODResult : TIME;      (* SUB_TOD_TODç»“æœ *)

(* DATE_AND_TIMEç±»å‹ç»“æœ *)
AddDTTimeResult : DATE_AND_TIME;   (* ADD_DT_TIMEç»“æœ *)
SubDTTimeResult : DATE_AND_TIME;   (* SUB_DT_TIMEç»“æœ *)

(* TIME_OF_DAYç±»å‹ç»“æœ *)
AddTODTimeResult : TIME_OF_DAY;    (* ADD_TOD_TIMEç»“æœ *)
SubTODTimeResult : TIME_OF_DAY;    (* SUB_TOD_TIMEç»“æœ *)
```

### æµ‹è¯•ç»“æœå˜é‡
æ¯ä¸ªæŒ‡ä»¤éƒ½æœ‰å¯¹åº”çš„å¸ƒå°”å˜é‡æ¥è®°å½•æµ‹è¯•ç»“æœï¼š
- `AddTimeOK`, `AddDTTimeOK`, `AddTODTimeOK`
- `MulTimeOK`, `DivTimeOK`
- `SubTimeOK`, `SubDTDTOK`, `SubDTTimeOK`, `SubDateDateOK`, `SubTODTimeOK`, `SubTODTODOK`

## æµ‹è¯•ç»“æœ

- **TestStep = 99**: æ‰€æœ‰11ä¸ªæ—¶é—´ç®—æœ¯æŒ‡ä»¤æµ‹è¯•é€šè¿‡ âœ…
- **TestStep = 88**: æœ‰æµ‹è¯•å¤±è´¥ âŒ
- **Errors**: æ˜¾ç¤ºå¤±è´¥çš„æµ‹è¯•æ•°é‡
- **TestsPassed**: æ€»ä½“æµ‹è¯•ç»“æœ

## å…¼å®¹æ€§è¯´æ˜

1. **æ—¶é—´æ ¼å¼**: ä½¿ç”¨IEC 61131-3æ ‡å‡†çš„æ—¶é—´å­—é¢å€¼æ ¼å¼
2. **ç²¾ç¡®æ¯”è¾ƒ**: æ—¶é—´ç±»å‹å¯ä»¥ç›´æ¥ä½¿ç”¨ `=` è¿›è¡Œç²¾ç¡®æ¯”è¾ƒ
3. **æ— éœ€å®¹å·®**: ä¸å®æ•°ä¸åŒï¼Œæ—¶é—´ç±»å‹æ¯”è¾ƒé€šå¸¸æ˜¯ç²¾ç¡®çš„ï¼Œæ— éœ€è€ƒè™‘æµ®ç‚¹è¯¯å·®
4. **ğŸ”§ éš”ç¦»æ€§**: æ¯ä¸ªæµ‹è¯•ä½¿ç”¨ç‹¬ç«‹å˜é‡ï¼Œé¿å…ç»“æœç›¸äº’å¹²æ‰°

## ä½¿ç”¨æ–¹æ³•

1. è®¾ç½® `Enable = TRUE` å¯åŠ¨æµ‹è¯•
2. ç¨‹åºä¼šä¾æ¬¡æ‰§è¡Œæ‰€æœ‰11ä¸ªæ—¶é—´ç®—æœ¯æŒ‡ä»¤æµ‹è¯•
3. è§‚å¯Ÿ `TestStep` å’Œ `Errors` å˜é‡æŸ¥çœ‹æµ‹è¯•è¿›åº¦å’Œç»“æœ
4. `Complete = TRUE` è¡¨ç¤ºæµ‹è¯•æ‰§è¡Œå®Œæ¯•

## æ–‡ä»¶è¯´æ˜

- **time_arithmetic_test.st**: ç‹¬ç«‹çš„ç»“æ„åŒ–æ–‡æœ¬æ–‡ä»¶
- **time_plc.xml**: Beremizé¡¹ç›®æ–‡ä»¶æ ¼å¼
- **æœ¬æ–‡æ¡£**: æµ‹è¯•è¯´æ˜å’Œä½¿ç”¨æŒ‡å¯¼

è¿™ä¸ªæµ‹è¯•ç¨‹åºå®Œå–„äº†PLCç®—æœ¯æŒ‡ä»¤çš„æµ‹è¯•è¦†ç›–èŒƒå›´ï¼Œç¡®ä¿æ—¶é—´ç›¸å…³çš„è¿ç®—åŠŸèƒ½æ­£å¸¸å·¥ä½œã€‚

## STæµ‹è¯•ä»£ç 

```
PROGRAM TimeArithmeticTest
VAR
 Enable : BOOL;
 Complete : BOOL;
 
 (* æ—¶é—´å˜é‡ *)
 TestTime1 : TIME;
 TestTime2 : TIME;
 AddTimeResult : TIME;
 MulTimeResult : TIME;
 DivTimeResult : TIME;
 SubTimeResult : TIME;
 SubDTDTResult : TIME;
 SubDateDateResult : TIME;
 SubTODTODResult : TIME;
 
 (* æ—¥æœŸæ—¶é—´å˜é‡ *)
 TestDT1 : DATE_AND_TIME;
 TestDT2 : DATE_AND_TIME;
 AddDTTimeResult : DATE_AND_TIME;
 SubDTTimeResult : DATE_AND_TIME;
 
 (* æ—¥æœŸå˜é‡ *)
 TestDate1 : DATE;
 TestDate2 : DATE;
 DateResult : DATE;
 
 (* æ—¶åˆ»å˜é‡ *)
 TestTOD1 : TIME_OF_DAY;
 TestTOD2 : TIME_OF_DAY;
 AddTODTimeResult : TIME_OF_DAY;
 SubTODTimeResult : TIME_OF_DAY;
 
 (* æµ‹è¯•ç»“æœåˆ¤æ–­å˜é‡ *)
 AddTimeOK : BOOL;
 AddDTTimeOK : BOOL;
 AddTODTimeOK : BOOL;
 MulTimeOK : BOOL;
 DivTimeOK : BOOL;
 SubTimeOK : BOOL;
 SubDTDTOK : BOOL;
 SubDTTimeOK : BOOL;
 SubDateDateOK : BOOL;
 SubTODTimeOK : BOOL;
 SubTODTODOK : BOOL;
 
 (* æ§åˆ¶å˜é‡ *)
 TestStep : INT;
 TestsPassed : BOOL;
 Errors : INT;
 
 (* æœŸæœ›å€¼æ¯”è¾ƒç”¨çš„ä¸´æ—¶å˜é‡ *)
 ExpectedTime : TIME;
 ExpectedDT : DATE_AND_TIME;
 ExpectedDate : DATE;
 ExpectedTOD : TIME_OF_DAY;
END_VAR

BEGIN
  Enable := TRUE;
  
  (* åˆå§‹åŒ–æµ‹è¯•æ•°æ® *)
  TestTime1 := T#10s;          (* 10ç§’ *)
  TestTime2 := T#5s;           (* 5ç§’ *)
  
  TestDT1 := DT#2024-01-15-10:30:00;
  TestDT2 := DT#2024-01-10-08:15:00;
  
  TestDate1 := D#2024-01-15;
  TestDate2 := D#2024-01-10;
  
  TestTOD1 := TOD#10:30:00;
  TestTOD2 := TOD#08:15:00;

  IF Enable THEN
      
      (* ADD_TIME æµ‹è¯• *)
      TestStep := 1;
      AddTimeResult := ADD_TIME(TestTime1, TestTime2);
      ExpectedTime := T#15s;
      AddTimeOK := (AddTimeResult = ExpectedTime);
      
      (* ADD_DT_TIME æµ‹è¯• - æ—¥æœŸæ—¶é—´åŠ æ—¶é—´ *)
      TestStep := 2;
      AddDTTimeResult := ADD_DT_TIME(TestDT1, TestTime1);
      (* æœŸæœ›ç»“æœï¼š2024-01-15-10:30:10 *)
      ExpectedDT := DT#2024-01-15-10:30:10;
      AddDTTimeOK := (AddDTTimeResult = ExpectedDT);
      
      (* ADD_TOD_TIME æµ‹è¯• - æ—¶åˆ»åŠ æ—¶é—´ *)
      TestStep := 3;
      AddTODTimeResult := ADD_TOD_TIME(TestTOD1, TestTime1);
      (* æœŸæœ›ç»“æœï¼š10:30:10 *)
      ExpectedTOD := TOD#10:30:10;
      AddTODTimeOK := (AddTODTimeResult = ExpectedTOD);
      
      (* MULTIME æµ‹è¯• - æ—¶é—´ä¹˜ä»¥æ•°å€¼ *)
      TestStep := 4;
      MulTimeResult := MULTIME(TestTime2, 3);
      ExpectedTime := T#15s;  (* 5s * 3 = 15s *)
      MulTimeOK := (MulTimeResult = ExpectedTime);
      
      (* DIVTIME æµ‹è¯• - æ—¶é—´é™¤ä»¥æ•°å€¼ *)
      TestStep := 5;
      DivTimeResult := DIVTIME(TestTime1, 2);
      ExpectedTime := T#5s;   (* 10s / 2 = 5s *)
      DivTimeOK := (DivTimeResult = ExpectedTime);
      
      (* SUB_TIME æµ‹è¯• - æ—¶é—´å‡æ—¶é—´ *)
      TestStep := 6;
      SubTimeResult := SUB_TIME(TestTime1, TestTime2);
      ExpectedTime := T#5s;   (* 10s - 5s = 5s *)
      SubTimeOK := (SubTimeResult = ExpectedTime);
      
      (* SUB_DT_DT æµ‹è¯• - æ—¥æœŸæ—¶é—´å‡æ—¥æœŸæ—¶é—´ *)
      TestStep := 7;
      SubDTDTResult := SUB_DT_DT(TestDT1, TestDT2);
      (* 2024-01-15-10:30:00 - 2024-01-10-08:15:00 = 5å¤©2å°æ—¶15åˆ†é’Ÿ *)
      ExpectedTime := T#5d2h15m;
      SubDTDTOK := (SubDTDTResult = ExpectedTime);
      
      (* SUB_DT_TIME æµ‹è¯• - æ—¥æœŸæ—¶é—´å‡æ—¶é—´ *)
      TestStep := 8;
      SubDTTimeResult := SUB_DT_TIME(TestDT1, TestTime1);
      (* 2024-01-15-10:30:00 - 10s = 2024-01-15-10:29:50 *)
      ExpectedDT := DT#2024-01-15-10:29:50;
      SubDTTimeOK := (SubDTTimeResult = ExpectedDT);
      
      (* SUB_DATE_DATE æµ‹è¯• - æ—¥æœŸå‡æ—¥æœŸ *)
      TestStep := 9;
      SubDateDateResult := SUB_DATE_DATE(TestDate1, TestDate2);
      ExpectedTime := T#5d;   (* 5å¤© *)
      SubDateDateOK := (SubDateDateResult = ExpectedTime);
      
      (* SUB_TOD_TIME æµ‹è¯• - æ—¶åˆ»å‡æ—¶é—´ *)
      TestStep := 10;
      SubTODTimeResult := SUB_TOD_TIME(TestTOD1, TestTime1);
      (* 10:30:00 - 10s = 10:29:50 *)
      ExpectedTOD := TOD#10:29:50;
      SubTODTimeOK := (SubTODTimeResult = ExpectedTOD);
      
      (* SUB_TOD_TOD æµ‹è¯• - æ—¶åˆ»å‡æ—¶åˆ» *)
      TestStep := 11;
      SubTODTODResult := SUB_TOD_TOD(TestTOD1, TestTOD2);
      (* 10:30:00 - 08:15:00 = 2:15:00 *)
      ExpectedTime := T#2h15m;
      SubTODTODOK := (SubTODTODResult = ExpectedTime);
      
      (* ç»Ÿè®¡ç»“æœ *)
      Errors := 0;
      IF NOT AddTimeOK THEN Errors := Errors + 1; END_IF;
      IF NOT AddDTTimeOK THEN Errors := Errors + 1; END_IF;
      IF NOT AddTODTimeOK THEN Errors := Errors + 1; END_IF;
      IF NOT MulTimeOK THEN Errors := Errors + 1; END_IF;
      IF NOT DivTimeOK THEN Errors := Errors + 1; END_IF;
      IF NOT SubTimeOK THEN Errors := Errors + 1; END_IF;
      IF NOT SubDTDTOK THEN Errors := Errors + 1; END_IF;
      IF NOT SubDTTimeOK THEN Errors := Errors + 1; END_IF;
      IF NOT SubDateDateOK THEN Errors := Errors + 1; END_IF;
      IF NOT SubTODTimeOK THEN Errors := Errors + 1; END_IF;
      IF NOT SubTODTODOK THEN Errors := Errors + 1; END_IF;
      
      TestsPassed := (Errors = 0);
      Complete := TRUE;
      
      IF TestsPassed THEN
          TestStep := 99;  (* æ‰€æœ‰æµ‹è¯•é€šè¿‡ *)
      ELSE
          TestStep := 88;  (* æœ‰æµ‹è¯•å¤±è´¥ *)
      END_IF;

  ELSE
      TestStep := 0;
      Complete := FALSE;
      TestsPassed := FALSE;
      Errors := 0;
  END_IF;

END_PROGRAM