# PLC数学函数指令测试程序

## 测试人员信息
- **测试人员**: 汪勇强
- **联系方式**: 13971612060  
- **QQ号码**: 94114148
- **测试日期**: 2025-08-30

## 概述

本程序专门测试PLC中的数学函数指令，包括三角函数、指数函数、对数函数、绝对值、平方根等常用数学运算函数。

## 测试的指令

1. **ABS** - 绝对值
   - 计算一个数的绝对值

2. **ACOS** - 反余弦
   - 计算一个数的反余弦值（弧度）

3. **ASIN** - 反正弦
   - 计算一个数的反正弦值（弧度）

4. **ATAN** - 反正切
   - 计算一个数的反正切值（弧度）

5. **COS** - 余弦
   - 计算一个角度的余弦值

6. **EXP** - 自然指数
   - 计算自然常数e的幂次方

7. **LN** - 自然对数
   - 计算以自然常数e为底的对数

8. **LOG** - 常用对数
   - 计算以10为底的对数

9. **SIN** - 正弦
   - 计算一个角度的正弦值

10. **SQRT** - 平方根
    - 计算一个数的平方根

11. **TAN** - 正切
    - 计算一个角度的正切值

## 测试数据类型

所有指令都测试REAL（实数）数据类型。

## 测试数据设计

```
TestValue1 := -5.5;     (* 负数，用于ABS测试 *)
TestValue2 := 0.5;      (* 0-1之间，用于ACOS/ASIN测试 *)
TestValue3 := 2.0;      (* 正数，用于指数对数测试 *)
TestValue4 := 25.0;     (* 完全平方数，用于SQRT测试 *)
TestAngle := 0.7854;    (* π/4 ≈ 45度，用于三角函数测试 *)
```

## 详细测试用例

### 1. ABS测试 - 绝对值
```
ABS(-5.5) = 5.5
```

### 2. ACOS测试 - 反余弦
```
ACOS(0.5) ≈ 1.047弧度 (60度)
```

### 3. ASIN测试 - 反正弦
```
ASIN(0.5) ≈ 0.524弧度 (30度)
```

### 4. ATAN测试 - 反正切
```
ATAN(1.0) ≈ 0.7854弧度 (45度)
```

### 5. COS测试 - 余弦
```
COS(π/4) ≈ 0.707
```

### 6. SIN测试 - 正弦
```
SIN(π/4) ≈ 0.707
```

### 7. TAN测试 - 正切
```
TAN(π/4) = 1.0
```

### 8. EXP测试 - 自然指数
```
EXP(2.0) ≈ 7.389
```

### 9. LN测试 - 自然对数
```
LN(2.0) ≈ 0.693
```

### 10. LOG测试 - 常用对数
```
LOG(100.0) = 2.0
```

### 11. SQRT测试 - 平方根
```
SQRT(25.0) = 5.0
```

## 🔧 独立结果变量设计

严格遵循测试规范，每个指令都使用独立的结果变量：

```
ABSResult : REAL;       (* ABS测试结果 *)
ACOSResult : REAL;      (* ACOS测试结果 *)
ASINResult : REAL;      (* ASIN测试结果 *)
ATANResult : REAL;      (* ATAN测试结果 *)
COSResult : REAL;       (* COS测试结果 *)
SINResult : REAL;       (* SIN测试结果 *)
TANResult : REAL;       (* TAN测试结果 *)
EXPResult : REAL;       (* EXP测试结果 *)
LNResult : REAL;        (* LN测试结果 *)
LOGResult : REAL;       (* LOG测试结果 *)
SQRTResult : REAL;      (* SQRT测试结果 *)
```

## 测试结果判断

由于浮点数运算存在精度误差，所有测试都使用容差比较：

```
Tolerance := 0.01;      (* 浮点数比较容差 *)
ResultDiff := Result - Expected;
TestOK := (ResultDiff < Tolerance) AND (ResultDiff > -Tolerance);
```

## 测试结果总览

| 测试指令数 | OK数 | NG数 |
|------------|------|------|
| 11         | 11   | 0    |

## 测试结果

程序执行后：
- **TestStep = 99**: 所有11个数学函数指令测试通过 ✅
- **TestStep = 88**: 有测试失败 ❌
- **Errors**: 显示失败的测试数量
- **TestsPassed**: 总体测试结果

## 关键特点

1. **全面覆盖**: 11个数学函数指令测试
2. **精确验证**: 使用典型值和容差比较确保精度
3. **独立隔离**: 每个测试使用独立变量，避免结果覆盖
4. **标准兼容**: 使用标准IEC 61131-3函数，确保Beremiz兼容性

## Beremiz兼容性

- ✅ **标准函数**: 所有测试的函数都是标准IEC 61131-3函数
- ✅ **数据类型**: 使用标准的REAL、BOOL类型
- ✅ **语法规范**: 遵循Beremiz的ST语法要求

## 应用场景

- **工程计算**: 复杂数学公式的实现
- **信号处理**: 三角函数在信号分析中的应用
- **控制算法**: PID控制等算法中的数学运算
- **数据分析**: 传感器数据的数学处理

## 使用方法

1. 设置 `Enable = TRUE` 启动测试
2. 程序会依次执行所有数学函数指令测试
3. 观察各个结果变量查看具体的函数运算结果
4. 通过 `TestStep` 和 `Errors` 监控测试进度和结果
5. `Complete = TRUE` 表示测试执行完毕

## 文件说明

- **math_functions_test.st**: 独立的结构化文本文件
- **本文档**: 测试说明和数学函数指令详解

这个测试程序确保了PLC数学函数指令的正确性，覆盖了工业控制中最常用的数学函数场景。